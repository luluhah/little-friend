<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç”œèœœäº¤æ¢ç«™</title>
    <style>
        body {
            font-family: 'Arial Rounded MT Bold', 'Arial', sans-serif;
            margin: 0;
            padding: 0;
            background-image: url('images/bgc.png');
            background-size: cover;
            background-position: center;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }

        .game-container {
            width: 90%;
            max-width: 1200px;
            background-color: rgba(255, 255, 255, 0.9);
            border-radius: 20px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            padding: 20px;
            position: relative;
            overflow: hidden;
            display: none;
        }

        .start-screen,
        .victory-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(255, 255, 255, 0.9);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .victory-screen {
            display: none;
        }

        h1 {
            color: #66bb6a;
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.5rem;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
        }

        .game-area {
            display: flex;
            flex-direction: column;
            gap: 30px;
            justify-content: center;
            margin-bottom: 30px;
        }

        .fruits-row,
        .animals-row {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px;
            margin-bottom: 20px;
        }

        .fruit {
            width: 80px;
            height: 80px;
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
            cursor: grab;
            transition: transform 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: #555;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .fruit:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.15);
        }

        .fruit.inactive {
            opacity: 0.5;
            cursor: default;
        }

        .animal {
            position: relative;
            width: 120px;
            height: 120px;
            cursor: pointer;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            transition: all 0.3s;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .animal-img {
            width: 100%;
            height: 100px;
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
            margin-bottom: 5px;
        }

        .animal-name {
            font-weight: bold;
            color: #333;
        }

        .animal.selected {
            border: 3px solid #66bb6a;
            box-shadow: 0 0 15px rgba(102, 187, 106, 0.7);
        }

        .animal.happy {
            animation: spin 0.8s ease-in-out;
        }

        .animal .question-mark {
            position: absolute;
            top: 10px;
            right: 10px;
            width: 30px;
            height: 30px;
            background-color: rgba(255, 255, 0, 0.8);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 20px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
            z-index: 5;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        .message-box {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: white;
            padding: 20px 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            text-align: center;
            z-index: 100;
            display: none;
        }

        .message-box p {
            font-size: 1.2rem;
            margin-bottom: 15px;
        }

        .message-box button {
            background-color: #66bb6a;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            font-size: 1rem;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .message-box button:hover {
            background-color: #4caf50;
        }

        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 99;
            display: none;
        }

        .start-button,
        .victory-button {
            background-color: #66bb6a;
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 1.5rem;
            border-radius: 30px;
            cursor: pointer;
            transition: background-color 0.2s, transform 0.2s;
            margin-top: 20px;
        }

        .start-button:hover,
        .victory-button:hover {
            background-color: #4caf50;
            transform: scale(1.05);
        }

        .victory-text {
            font-size: 3rem;
            color: #66bb6a;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
            margin-bottom: 30px;
        }
    </style>
</head>

<body>
    <!-- å¼€å§‹ç•Œé¢ -->
    <div class="start-screen" id="start-screen">
        <h1>ç”œèœœäº¤æ¢ç«™</h1>
        <p>æ¬¢è¿æ¥åˆ°ç”œèœœäº¤æ¢ç«™ï¼åœ¨è¿™é‡Œï¼Œä½ éœ€è¦å°†æ°´æœæ‹–æ”¾åˆ°å¯¹åº”çš„åŠ¨ç‰©èº«ä¸Šã€‚</p>
        <p>æ¯ä¸ªåŠ¨ç‰©éƒ½æœ‰å®ƒå–œæ¬¢çš„æ°´æœï¼Œç‚¹å‡»åŠ¨ç‰©å¯ä»¥æŸ¥çœ‹æç¤ºã€‚</p>
        <button class="start-button" id="start-button">å¼€å§‹æ¸¸æˆ</button>
    </div>

    <!-- æ¸¸æˆç•Œé¢ -->
    <div class="game-container" id="game-container">
        <h1>ç”œèœœäº¤æ¢ç«™</h1>
        <div class="fruits-row" id="fruits-row"></div>
        <div class="animals-row" id="animals-row"></div>
    </div>

    // èƒœåˆ©ç•Œé¢
    <div class="victory-screen" id="victory-screen">
        <h1 class="victory-text">æ­å–œä½ ï¼ä½ çœŸæ˜¯å¤ªæ£’äº†ï¼</h1>
        <button class="victory-button" id="restart-button">è¿›å…¥ä¸‹ä¸€å…³</button>
    </div>



    <!-- æ¶ˆæ¯æ¡† -->
    <div class="overlay" id="overlay"></div>
    <div class="message-box" id="message-box">
        <p id="message-text"></p>
        <button id="message-btn">ç¡®å®š</button>
    </div>

    <!-- éŸ³é¢‘å…ƒç´  -->
    <audio id="background-music" src="sounds/bgc.mp3" loop preload="auto"></audio>
    <audio id="correct-sound" src="sounds/correct.mp3" preload="auto"></audio>
    <audio id="victory-sound" src="sounds/victory.mp3" preload="auto"></audio>

    <script>
        // æ¸¸æˆæ•°æ®
        const fruits = [
            { id: 'apple', name: 'è‹¹æœ', emoji: 'ğŸ' },
            { id: 'banana', name: 'é¦™è•‰', emoji: 'ğŸŒ' },
            { id: 'strawberry', name: 'è‰è“', emoji: 'ğŸ“' },
            { id: 'lemon', name: 'æŸ æª¬', emoji: 'ğŸ‹' },
            { id: 'grape', name: 'è‘¡è„', emoji: 'ğŸ‡' },
            { id: 'watermelon', name: 'è¥¿ç“œ', emoji: 'ğŸ‰' },
            { id: 'pear', name: 'æ¢¨', emoji: 'ğŸ' },
            { id: 'orange', name: 'æ©™å­', emoji: 'ğŸŠ' },
            { id: 'mango', name: 'èŠ’æœ', emoji: 'ğŸ¥­' },
            { id: 'papaya', name: 'æœ¨ç“œ', emoji: 'ğŸˆ' }
        ];

        const animals = [
            { id: 'fox', name: 'ç‹ç‹¸', fruit: 'lemon', img: 'huli.png', clue: 'æˆ‘æƒ³è¦... é…¸é…¸ç”œç”œçš„æ°´æœï¼' },
            { id: 'giraffe', name: 'é•¿é¢ˆé¹¿', fruit: 'banana', img: 'changjinglu.png', clue: 'æˆ‘å–œæ¬¢æ ‘ä¸Šæ‘˜çš„ï¼Œé•¿é•¿çš„...' },
            { id: 'hedgehog', name: 'åˆºçŒ¬', fruit: 'apple', img: 'ciwei.png', clue: 'æˆ‘è¦è‹¹æœï¼' },
            { id: 'squirrel', name: 'æ¾é¼ ', fruit: 'grape', img: 'songshu.png', clue: 'æˆ‘æƒ³è¦ä¸€ä¸²ç´«è‰²çš„å°æ°´æœ...' },
            { id: 'elephant', name: 'å¤§è±¡', fruit: 'watermelon', img: 'daxiang.png', clue: 'æˆ‘æƒ³è¦åˆå¤§åˆåœ†çš„æ°´æœ...' },
            { id: 'rabbit', name: 'å…”å­', fruit: 'strawberry', img: 'tuzi.png', clue: 'æˆ‘æƒ³è¦çº¢çº¢çš„æ°´æœ...' },
            { id: 'monkey', name: 'çŒ´å­', fruit: 'mango', img: 'houzi.png', clue: 'æˆ‘æƒ³è¦é»„è‰²çš„ï¼Œç”œç”œçš„æ°´æœ...' },
            { id: 'koala', name: 'è€ƒæ‹‰', fruit: 'pear', img: 'kaola.png', clue: 'æˆ‘æƒ³è¦çœ‹èµ·æ¥åƒæˆ‘è€³æœµçš„æ°´æœ...' }
        ];

        const animalElements = [];

        // æ¸¸æˆçŠ¶æ€
        let gameState = {
            matchedPairs: 0,
            totalPairs: animals.length,
            matchedFruits: new Set(),
            matchedAnimals: new Set()
        };

        // DOM å…ƒç´ 
        const startScreen = document.getElementById('start-screen');
        const gameContainer = document.getElementById('game-container');
        const victoryScreen = document.getElementById('victory-screen');
        const startButton = document.getElementById('start-button');
        const restartButton = document.getElementById('restart-button');
        const fruitsRow = document.getElementById('fruits-row');
        const animalsRow = document.getElementById('animals-row');
        const messageBox = document.getElementById('message-box');
        const messageText = document.getElementById('message-text');
        const messageBtn = document.getElementById('message-btn');
        const overlay = document.getElementById('overlay');

        // éŸ³é¢‘å…ƒç´ 
        const backgroundMusic = document.getElementById('background-music');
        const correctSound = document.getElementById('correct-sound');
        const victorySound = document.getElementById('victory-sound');

        // è®¾ç½®correctSoundçš„æ’­æ”¾é€Ÿåº¦ä¸º1.5å€ï¼ŒéŸ³é‡ä¸º0.5
        correctSound.playbackRate = 1.5;
        correctSound.volume = 0.5;

        // åˆå§‹åŒ–æ¸¸æˆ
        function initGame() {
            gameState = {
                matchedPairs: 0,
                totalPairs: animals.length,
                matchedFruits: new Set(),
                matchedAnimals: new Set()
            };

            renderFruits();
            renderAnimals();

            // å°è¯•æ’­æ”¾èƒŒæ™¯éŸ³ä¹
            backgroundMusic.play().catch(e => {
                console.log('è‡ªåŠ¨æ’­æ”¾èƒŒæ™¯éŸ³ä¹å¤±è´¥ï¼Œè¯·ç”¨æˆ·äº¤äº’åæ’­æ”¾ã€‚', e);
            });
        }

        // æ¸²æŸ“æ°´æœ
        function renderFruits() {
            fruitsRow.innerHTML = '';
            fruits.forEach(fruit => {
                if (!gameState.matchedFruits.has(fruit.id)) {
                    const fruitElement = document.createElement('div');
                    fruitElement.className = 'fruit';
                    fruitElement.dataset.id = fruit.id;
                    fruitElement.innerHTML = `<div style="font-size: 2rem;">${fruit.emoji}</div>`;
                    fruitElement.draggable = true;
                    fruitElement.addEventListener('dragstart', dragStart);
                    fruitsRow.appendChild(fruitElement);
                }
            });
        }

        // æ¸²æŸ“åŠ¨ç‰©
        function renderAnimals() {
            animalsRow.innerHTML = '';
            animals.forEach(animal => {
                const animalElement = document.createElement('div');
                animalElement.className = 'animal';
                animalElement.dataset.id = animal.id;
                animalElements.push(animalElement);

                const questionMark = document.createElement('div');
                questionMark.className = 'question-mark';
                questionMark.textContent = '?';

                const imgElement = document.createElement('img');
                imgElement.src = `images/${animal.img}`;
                imgElement.alt = animal.name;
                imgElement.style.width = '100%';
                imgElement.style.height = '100px';
                imgElement.style.objectFit = 'contain';

                animalElement.appendChild(imgElement);
                animalElement.appendChild(document.createElement('br'));
                animalElement.appendChild(document.createTextNode(animal.name));
                animalElement.appendChild(questionMark);

                animalsRow.appendChild(animalElement);

                animalElement.addEventListener('click', () => {
                    showMessage(animal.clue);
                });

                animalElement.addEventListener('dragover', allowDrop);
                animalElement.addEventListener('drop', drop);
            });
        }

        // æ‹–æ‹½å¼€å§‹
        function dragStart(e) {
            e.dataTransfer.setData('text/plain', e.target.dataset.id);
        }

        // æ‹–æ‹½ç»è¿‡
        function allowDrop(e) {
            e.preventDefault();
        }

        // æ”¾ç½®
        function drop(e) {
            e.preventDefault();
            const fruitId = e.dataTransfer.getData('text/plain');
            const animalId = e.target.closest('.animal')?.dataset.id;

            if (animalId) {
                const animal = animals.find(a => a.id === animalId);
                const fruit = fruits.find(f => f.id === fruitId);
                if (fruit && animal) {
                    if (fruit.id === animal.fruit) {
                        correctMatch(animalId, fruitId, animal.name, fruit.name);
                    } else {
                        wrongMatch(animal.name, fruit.name);
                    }
                }
            }
        }

        // æ­£ç¡®åŒ¹é…
        function correctMatch(animalId, fruitId, animalName, fruitName) {
            gameState.matchedPairs++;
            gameState.matchedFruits.add(fruitId);
            gameState.matchedAnimals.add(animalId);

            const fruitElement = document.querySelector(`.fruit[data-id="${fruitId}"]`);
            if (fruitElement) {
                fruitElement.classList.add('inactive');
                fruitElement.draggable = false;
            }

            animalElements.forEach(animalElement => {
                if (animalElement.dataset.id === animalId) {
                    const questionMark = animalElement.querySelector('.question-mark');
                    if (questionMark) {
                        questionMark.style.display = 'none';
                    }
                }
            });

            // æ’­æ”¾æ­£ç¡®éŸ³æ•ˆ
            // correctSound.currentTime = 0;
            // correctSound.play().catch(e => console.log('æ’­æ”¾æ­£ç¡®éŸ³æ•ˆå¤±è´¥:', e));

            showMessage(`å¤ªå¥½åƒå•¦ï¼${animalName}å¾ˆå–œæ¬¢è¿™ä¸ª${fruitName}ï¼`);

            if (gameState.matchedPairs === gameState.totalPairs) {
                setTimeout(() => {
                    // æ˜¾ç¤ºèƒœåˆ©ç•Œé¢
                    gameContainer.style.display = 'none';
                    victoryScreen.style.display = 'flex';
                    // åœæ­¢èƒŒæ™¯éŸ³ä¹
                    backgroundMusic.pause();
                    backgroundMusic.currentTime = 0;
                    // æ’­æ”¾èƒœåˆ©éŸ³æ•ˆ
                    // victorySound.play().catch(e => console.log('æ’­æ”¾èƒœåˆ©éŸ³æ•ˆå¤±è´¥:', e));
                }, 1000);
            }
        }

        // é”™è¯¯åŒ¹é…
        function wrongMatch(animalName, fruitName) {
            showMessage(`è¿™ä¸ª${fruitName}ä¸æ˜¯${animalName}æƒ³è¦çš„...`);
        }

        // æ˜¾ç¤ºæ¶ˆæ¯
        function showMessage(text) {
            messageText.textContent = text;
            messageBox.style.display = 'block';
            overlay.style.display = 'block';

            setTimeout(() => {
                messageBox.style.display = 'none';
                overlay.style.display = 'none';
            }, 1500);
        }

        // äº‹ä»¶ç›‘å¬
        messageBtn.addEventListener('click', () => {
            messageBox.style.display = 'none';
            overlay.style.display = 'none';
        });

        overlay.addEventListener('click', () => {
            messageBox.style.display = 'none';
            overlay.style.display = 'none';
        });

        // å¼€å§‹æ¸¸æˆæŒ‰é’®
        startButton.addEventListener('click', () => {
            startScreen.style.display = 'none';
            gameContainer.style.display = 'block';
            initGame();
        });

        // é‡æ–°å¼€å§‹æŒ‰é’®é€»è¾‘
        restartButton.addEventListener('click', () => {
            // ä½¿ç”¨window.location.hrefæ¥å®ç°é¡µé¢è·³è½¬åˆ°guanqia3.html
            window.location.href = 'guanqia3.html';
        });

        // åˆå§‹åŒ–æ˜¾ç¤ºå¼€å§‹ç•Œé¢
        startScreen.style.display = 'flex';
    </script>
</body>

</html>